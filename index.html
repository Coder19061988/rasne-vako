<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>3PL Rasne API — Документація</title>
    <link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,700|Roboto:300,400,700" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/redoc/bundles/redoc.standalone.js"></script>
    <style>
        /* Темний стиль для таблиць у документації (опис полів номенклатури, одиниць виміру, штрихкодів) */
        #redoc-container table {
            background: #252525;
            border-collapse: collapse;
            border: 1px solid #444;
            border-radius: 15px;
        }
        #redoc-container th,
        #redoc-container td {
            border: 1px solid #444 !important;
            padding: 8px 12px !important;
        }
        #redoc-container th {
            background: #1a1a1a !important;
            color: #fff !important;
            font-weight: 600;
        }
        #redoc-container td {
            color: #e4e4e4 !important;
            background: #252525 !important;
        }
        #redoc-container tr:hover td {
            background: #2d2d2d;
        }
    </style>
</head>
<body>
    <div id="redoc-container"></div>
    <p id="spec-source" style="margin: 0.5rem 1rem; font-size: 0.85rem; color: #666;"></p>
    <script>
(function () {
    // ---------- URL специфікації: з файлу (оновлення з репо) або вбудована ----------
    // Можна задати через ?spec=... у посиланні, інакше використовується openapi.json поруч зі сторінкою
    var SPEC_URL = (function () {
        var p = new URLSearchParams(window.location.search);
        return p.get('spec') || 'openapi.json';
    })();

    // Специфікація завантажується тільки з openapi.json (редагуйте той файл, не цей).

    var redocOpts = { hideDownloadButton: false, jsonSampleExpandLevel: 15 };
    var container = document.getElementById('redoc-container');
    var sourceEl = document.getElementById('spec-source');

    var currentSpec;
    function initRedoc(specToUse, sourceLabel) {
        currentSpec = specToUse;
        if (sourceLabel) {
            sourceEl.textContent = sourceLabel;
            sourceEl.innerHTML += ' — <a href="#" id="export-spec-link">Завантажити openapi.json</a>';
            document.getElementById('export-spec-link').onclick = function (e) {
                e.preventDefault();
                var a = document.createElement('a');
                a.href = 'data:application/json;charset=utf-8,' + encodeURIComponent(JSON.stringify(currentSpec, null, 2));
                a.download = 'openapi.json';
                a.click();
            };
        }
        Redoc.init(specToUse, redocOpts, container);
    }

    function showSpecError() {
        sourceEl.textContent = '';
        container.innerHTML = '<p style="padding:1rem;color:#c00">Не вдалося завантажити openapi.json. Переконайтесь, що файл openapi.json лежить у тій самій папці, що й ця сторінка.</p>';
    }

    fetch(SPEC_URL)
        .then(function (r) { if (!r.ok) throw new Error(r.status); return r.json(); })
        .then(function (loadedSpec) {
            initRedoc(loadedSpec, 'Специфікація завантажена з ' + SPEC_URL);
        })
        .catch(showSpecError);

    /* (вбудована спека видалена — джерело: openapi.json) */
})();
    </script>
</body>
</html>
